#### 1.
##### CVE-2021–30657 macOS Gatekeeper Bypass 
```
A logic issue was addressed with improved state management. This issue is fixed in macOS Big Sur 11.3, Security Update 2021-002 Catalina. A malicious application may bypass Gatekeeper checks. Apple is aware of a report that this issue may have been actively exploited..
```

macOS Gatekeeper Bypass (2021 Edition) by Cedric Owens - macOS Catalina 10.15 (specifically tested on 10.15.7) and in macOS Big Sur before Big Sur 11.3 allows an attacker to very easily craft a macOS payload that is not checked by Gatekeeper. This can be used in phishing and all the victim has to do is double click to open the .dmg and double-click the fake app inside of the .dmg — no pop ups or warnings from macOS are generated.

##### Defense / Remediation: Update to Big Sur 11.3 or Catalina update 2021–002, where Apple has patched this bug.

`https://objective-see.com/blog/blog_0x64.html`
`https://objective-see.com/blog/blog_0x47.html`


#### 2.
##### CVE-2021-30860 zero-click vulnerability FORCEDENTRY
```
An integer overflow was addressed with improved input validation. This issue is fixed in Security Update 2021-005 Catalina, iOS 14.8 and iPadOS 14.8, macOS Big Sur 11.6, watchOS 7.6.2. Processing a maliciously crafted PDF may lead to arbitrary code execution. Apple is aware of a report that this issue may have been actively exploited.
```

CVE-2021-30860 is an integer overflow in the CoreGraphics component, specifically the decoding of a JBIG2 data. JBIG2 (Joint Bi-level Image Experts Group) is an image compression format which can be embedded as a stream in a PDF or PSD document, or potentially other formats as well.

- IOS 14 [BlastDoor](https://googleprojectzero.blogspot.com/2021/01/a-look-at-imessage-in-ios-14.html)

CoreGraphics.dylib. A vulnerable version of the .dylib (macOS 11.5.2) and a fixed version (in macOS 11.6) For analysis. Found under /System/Library/dyld/. Opening the dyld_shared_cache_x86_64 file in Hopper presents you with myriad of Frameworks to examine. Filter on the “CoreGraphics” one to open it up. Using Hopper to output the CoreGraphics.dylib to its own dedicated Mach-O file. To do this, we can use the “File->Produce New Executable” (or cmd+shift+e). diff these quickly, using IDA and BinDiff. 

An integer overflow is often paired with 1 or more other mistakes. For example, it is used in an allocation routine to allocate dynamic memory. That is exactly the case here.

##### Defense / Remediation: macOS versions prior to OSX Big Sur 11.6 affected; So update.
`https://objective-see.com/blog/blog_0x67.html`


#### 3.
##### CVE-2021-30853 Bypassing file quarantine, gatekeeper, & notarization requirements ...again!
```
Discovered and reported by Gordon Long (@ethicalhax) effective in macOS v11 - 11.5.
Earlier found and detailed in CVE-2021-30657. This bug, discovered by Cedric Owens, also allowed “a malicious application [to] bypass Gatekeeper checks” (which I determined was due to flaw in Apple’s user-mode system policy daemon).
```
```
Though both CVE-2021-30657 and CVE-2021-30853 have the same impact, and upon initial triage seem closely related, a detailed analysis reveals that the bug we’re discussing today (CVE-2021-30853), is due to a completely separate flaw (found within the kernel).
```
POC [link](https://objective-see.com/downloads/blog/blog_0x6A/PoC.zip) from the awesome objective-see [blog 0x6A](https://objective-see.com/blog/blog_0x6A.html)

To uncover the root cause of this flaw let’s start by exploring how processes (well, applications) are launched on macOS, focusing on the code paths triggered by this PoC.

Launching an application is a surprisingly complex process. Since 2016 see link to [talk](https://files.speakerdeck.com/presentations/9e724ea233434f9fb083bff26bc7fb4b/ShmooCon_2016.pdf) here,  Apple has expanded (read: complicated) this process, adding XPC calls into its system policy daemon, syspolicyd, and its XProtect (anti-virus) agent, XprotectService. As part of this complex application launching process, the system (is supposed to) ensure that any application downloaded from the Internet is blocked unless it is signed and notarized.

…and even when an application is both signed and notarized, an alert should still shown to the user, informing them that they are launching executable content from the (untrusted) Internet. Unfortunately due to both the complexity and many component involved in this process, determining which component (daemon, framework, or even kernel extension) is responsible for this bug, is not a trivial exercise.

`% log stream --level debug --predicate="processImagePath contains[c] 'syspolicyd'"`

This was especially strange considering that syspolicyd should always display some log messages, as it is largely the arbiter in determining if an application should be allowed to run. (Note that syspolicyd is responsible for evaluating launched applications, and blocking ones it deems untrusted …as well as alerting the user to this fact via an XPC call to CoreServicesUIAgent. If it is not invoked, the application will not be evaluated, and thus will simply be allowed to run!).

On macOS, launchd is the daemon responsible to launching (all?) processes. Though Apple decided to close-source it, the source code of older versions, such as version 842.92.1 are still available (via opensource.apple.com). Perusing that code we can see it executes /usr/libexec/xpcproxy to handle the launch of applications, such as our PoC.

`# ProcessMonitor.app/Contents/MacOS/ProcessMonitor -pretty`



##### Defense / Remediation: Fixed, patched in macOS Big Sur 11.6, 12 beta 6 onwards
`  `

#### 4.
##### CVE-2021-30657
```
https://objective-see.com/blog/blog_0x64.html
Apple patched the bug as CVE-2021-30657, noting "a malicious application may bypass Gatekeeper checks"

```


% log stream --level debug


##### Defense / Remediation: 
`  `

#### 5. 
##### CVE-2019–8513: TimeMachine root command injection 
```
In macOS Mojave 10.14.4 Apple patched several local privilege escalation (LPE) flaws I reported, such as CVE-2019-8513 (TimeMachine) and CVE-2019-8530 (XPC).

The flaw resides in the tmdiagnose binary, which is not too hard to reverse. Its implementation is just some external shell command wrapped in NSTask calls and the terminal output is honest.

The executable /usr/local/bin/ddt does not exist on a fresh installed mac. The location is not protected by rootless, and the popular package manager brew explicitly set this directory to world writable. So on a macOS with brew installed (don’t you?), a normal user process can overwrite this file and send an XPC message to execute it as root.
```
`Rootpipe Reborn (Part I)`
##### Defense / Remediation: Upgrade to 10.14.4++ ASAP!

`Rootpipe Reborn (Part II)`:
[blog](https://objective-see.com/blog/blog_0x41.html)
